Tue Jan 21 08:42:25 PM CET 2025
Bringing machine 'master' up with 'libvirt' provider...
Bringing machine 'worker1' up with 'libvirt' provider...
Bringing machine 'worker2' up with 'libvirt' provider...
==> master: Checking if box 'cloud-image/ubuntu-24.04' version '20240822.0.0' is up to date...
==> worker1: Checking if box 'cloud-image/ubuntu-24.04' version '20240822.0.0' is up to date...
[fog][WARNING] Unrecognized arguments: libvirt_ip_command
[fog][WARNING] Unrecognized arguments: libvirt_ip_command
==> worker2: Checking if box 'cloud-image/ubuntu-24.04' version '20240822.0.0' is up to date...
[fog][WARNING] Unrecognized arguments: libvirt_ip_command
==> master: Creating image (snapshot of base box volume).
==> worker1: Creating image (snapshot of base box volume).
==> master: Creating domain with the following settings...
==> worker1: Creating domain with the following settings...
==> master:  -- Name:              kubernetes_on_libvirt_master
==> worker1:  -- Name:              kubernetes_on_libvirt_worker1
==> master:  -- Description:       Source: /home/berto/src/kubernetes_on_libvirt/Vagrantfile
==> worker1:  -- Description:       Source: /home/berto/src/kubernetes_on_libvirt/Vagrantfile
==> master:  -- Domain type:       kvm
==> worker1:  -- Domain type:       kvm
==> master:  -- Cpus:              2
==> worker1:  -- Cpus:              2
==> master:  -- Feature:           acpi
==> worker1:  -- Feature:           acpi
==> worker2: Creating image (snapshot of base box volume).
==> worker1:  -- Feature:           apic
==> worker2: Creating domain with the following settings...
==> worker1:  -- Feature:           pae
==> worker2:  -- Name:              kubernetes_on_libvirt_worker2
==> worker1:  -- Clock offset:      utc
==> worker2:  -- Description:       Source: /home/berto/src/kubernetes_on_libvirt/Vagrantfile
==> worker1:  -- Memory:            8192M
==> worker2:  -- Domain type:       kvm
==> worker1:  -- Base box:          cloud-image/ubuntu-24.04
==> worker2:  -- Cpus:              2
==> worker1:  -- Storage pool:      default
==> worker2:  -- Feature:           acpi
==> worker1:  -- Image(vda):        /var/lib/libvirt/images/kubernetes_on_libvirt_worker1.img, virtio, 10G
==> worker2:  -- Feature:           apic
==> worker1:  -- Disk driver opts:  cache='default'
==> worker2:  -- Feature:           pae
==> worker1:  -- Graphics Type:     vnc
==> worker2:  -- Clock offset:      utc
==> worker1:  -- Video Type:        cirrus
==> worker2:  -- Memory:            8192M
==> worker1:  -- Video VRAM:        16384
==> worker2:  -- Base box:          cloud-image/ubuntu-24.04
==> worker1:  -- Video 3D accel:    false
==> worker2:  -- Storage pool:      default
==> worker1:  -- Keymap:            en-us
==> worker2:  -- Image(vda):        /var/lib/libvirt/images/kubernetes_on_libvirt_worker2.img, virtio, 10G
==> worker1:  -- TPM Backend:       passthrough
==> worker2:  -- Disk driver opts:  cache='default'
==> worker1:  -- INPUT:             type=mouse, bus=ps2
==> worker2:  -- Graphics Type:     vnc
==> master:  -- Feature:           apic
==> worker2:  -- Video Type:        cirrus
==> master:  -- Feature:           pae
==> worker2:  -- Video VRAM:        16384
==> master:  -- Clock offset:      utc
==> worker2:  -- Video 3D accel:    false
==> master:  -- Memory:            8192M
==> worker2:  -- Keymap:            en-us
==> master:  -- Base box:          cloud-image/ubuntu-24.04
==> worker2:  -- TPM Backend:       passthrough
==> master:  -- Storage pool:      default
==> worker2:  -- INPUT:             type=mouse, bus=ps2
==> master:  -- Image(vda):        /var/lib/libvirt/images/kubernetes_on_libvirt_master.img, virtio, 10G
==> master:  -- Disk driver opts:  cache='default'
==> master:  -- Graphics Type:     vnc
==> master:  -- Video Type:        cirrus
==> master:  -- Video VRAM:        16384
==> master:  -- Video 3D accel:    false
==> master:  -- Keymap:            en-us
==> master:  -- TPM Backend:       passthrough
==> master:  -- INPUT:             type=mouse, bus=ps2
==> worker2: Creating shared folders metadata...
==> worker1: Creating shared folders metadata...
==> worker2: Starting domain.
==> worker1: Starting domain.
==> worker2: Domain launching with graphics connection settings...
==> worker1: Domain launching with graphics connection settings...
==> worker2:  -- Graphics Port:      5900
==> worker1:  -- Graphics Port:      5901
==> worker2:  -- Graphics IP:        127.0.0.1
==> worker1:  -- Graphics IP:        127.0.0.1
==> worker2:  -- Graphics Password:  Not defined
==> worker1:  -- Graphics Password:  Not defined
==> worker2:  -- Graphics Websocket: 5700
==> worker1:  -- Graphics Websocket: 5701
==> worker2: Waiting for domain to get an IP address...
==> worker1: Waiting for domain to get an IP address...
==> master: Creating shared folders metadata...
==> master: Starting domain.
==> master: Domain launching with graphics connection settings...
==> master:  -- Graphics Port:      5902
==> master:  -- Graphics IP:        127.0.0.1
==> master:  -- Graphics Password:  Not defined
==> master:  -- Graphics Websocket: 5702
==> master: Waiting for domain to get an IP address...
==> worker2: Waiting for machine to boot. This may take a few minutes...
==> worker1: Waiting for machine to boot. This may take a few minutes...
    worker2: SSH address: 192.168.121.159:22
    worker1: SSH address: 192.168.121.210:22
    worker2: SSH username: vagrant
    worker1: SSH username: vagrant
    worker2: SSH auth method: private key
    worker1: SSH auth method: private key
    worker2: Warning: Connection refused. Retrying...
    worker1: Warning: Connection refused. Retrying...
==> master: Waiting for machine to boot. This may take a few minutes...
    master: SSH address: 192.168.121.247:22
    master: SSH username: vagrant
    master: SSH auth method: private key
    master: Warning: Connection refused. Retrying...
    worker2: Warning: Remote connection disconnect. Retrying...
    master: Warning: Remote connection disconnect. Retrying...
    worker1: Warning: Remote connection disconnect. Retrying...
    worker2: 
    worker2: Vagrant insecure key detected. Vagrant will automatically replace
    worker2: this with a newly generated keypair for better security.
    master: 
    master: Vagrant insecure key detected. Vagrant will automatically replace
    master: this with a newly generated keypair for better security.
    worker1: 
    worker1: Vagrant insecure key detected. Vagrant will automatically replace
    worker1: this with a newly generated keypair for better security.
    worker2: 
    worker2: Inserting generated public key within guest...
    master: 
    master: Inserting generated public key within guest...
    worker1: 
    worker1: Inserting generated public key within guest...
    worker2: Removing insecure key from the guest if it's present...
    master: Removing insecure key from the guest if it's present...
    worker1: Removing insecure key from the guest if it's present...
    worker2: Key inserted! Disconnecting and reconnecting using new SSH key...
    master: Key inserted! Disconnecting and reconnecting using new SSH key...
    worker1: Key inserted! Disconnecting and reconnecting using new SSH key...
==> worker2: Machine booted and ready!
==> worker2: Setting hostname...
==> master: Machine booted and ready!
==> master: Setting hostname...
==> worker1: Machine booted and ready!
==> worker1: Setting hostname...
==> worker2: Configuring and enabling network interfaces...
==> master: Configuring and enabling network interfaces...
==> worker1: Configuring and enabling network interfaces...
==> worker2: Running provisioner: file...
==> master: Running provisioner: file...
    worker2: ./provision/.ssh/id_rsa => /home/vagrant/.ssh/id_rsa
==> worker2: Running provisioner: file...
    master: ./provision/.ssh/id_rsa => /home/vagrant/.ssh/id_rsa
==> master: Running provisioner: file...
==> worker1: Running provisioner: file...
    worker2: ./provision/.ssh/id_rsa.pub => /home/vagrant/.ssh/id_rsa.pub
==> worker2: Running provisioner: shell...
    master: ./provision/.ssh/id_rsa.pub => /home/vagrant/.ssh/id_rsa.pub
    worker1: ./provision/.ssh/id_rsa => /home/vagrant/.ssh/id_rsa
==> master: Running provisioner: shell...
    worker2: Running: inline script
==> worker1: Running provisioner: file...
==> worker2: Running provisioner: file...
    master: Running: inline script
    worker1: ./provision/.ssh/id_rsa.pub => /home/vagrant/.ssh/id_rsa.pub
==> master: Running provisioner: file...
    worker2: ./provision/common.sh => /tmp/common.sh
==> worker1: Running provisioner: shell...
==> worker2: Running provisioner: shell...
    master: ./provision/common.sh => /tmp/common.sh
    worker1: Running: inline script
==> master: Running provisioner: shell...
    worker2: Running: inline script
==> worker1: Running provisioner: file...
==> worker2: Running provisioner: file...
    master: Running: inline script
    worker1: ./provision/common.sh => /tmp/common.sh
==> master: Running provisioner: file...
    worker2: ./provision/worker2.sh => /tmp/worker2.sh
==> worker1: Running provisioner: shell...
==> worker2: Running provisioner: shell...
    master: ./provision/master.sh => /tmp/master.sh
    worker1: Running: inline script
==> master: Running provisioner: shell...
    worker2: Running: inline script
==> worker1: Running provisioner: file...
    master: Running: inline script
    worker1: ./provision/worker1.sh => /tmp/worker1.sh
    master: /tmp/master.sh: line 2: kubeadm: command not found
    master: cp: cannot stat '/etc/kubernetes/admin.conf': No such file or directory
    master: chown: cannot access '/root/.kube/config': No such file or directory
    master: /tmp/master.sh: line 8: kubectl: command not found
==> master: An error occurred. The error will be shown after all tasks complete.
==> worker1: Running provisioner: shell...
    worker1: Running: inline script
An error occurred while executing multiple actions in parallel.
Any errors that occurred are shown below.

An error occurred while executing the action on the 'master'
machine. Please handle this error then try again:

The SSH command responded with a non-zero exit status. Vagrant
assumes that this means the command failed. The output for this command
should be in the log above. Please read the output to determine what
went wrong.
Tue Jan 21 08:42:59 PM CET 2025
